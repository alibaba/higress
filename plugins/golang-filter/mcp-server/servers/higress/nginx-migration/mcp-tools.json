{
  "version": "2.0.0",
  "name": "nginx-migration",
  "description": "Nginx 到 Higress 迁移工具集：支持配置转换和 Lua 插件迁移",
  "tools": [
    {
      "name": "parse_nginx_config",
      "description": "解析和分析 Nginx 配置文件，识别配置结构和复杂度",
      "inputSchema": {
        "type": "object",
        "properties": {
          "config_content": {
            "type": "string",
            "description": "Nginx 配置文件内容"
          }
        },
        "required": ["config_content"]
      }
    },
    {
      "name": "convert_to_higress",
      "description": "智能解析 Nginx 配置并通过 AI 推理生成 Higress Ingress/HTTPRoute 配置。支持复杂配置（SSL、重写、重定向、upstream 等）的智能转换，结合 RAG 知识库提供准确的转换方案",
      "inputSchema": {
        "type": "object",
        "properties": {
          "config_content": {
            "type": "string",
            "description": "Nginx 配置文件内容"
          },
          "namespace": {
            "type": "string",
            "description": "目标 Kubernetes 命名空间",
            "default": "default"
          },
          "use_gateway_api": {
            "type": "boolean",
            "description": "是否使用 Gateway API (HTTPRoute)。默认 false，使用 Ingress",
            "default": false
          }
        },
        "required": ["config_content"]
      }
    },
    {
      "name": "analyze_lua_plugin",
      "description": "分析 Nginx Lua 插件的兼容性，识别使用的 API 和潜在迁移问题，返回结构化分析结果供后续工具使用",
      "inputSchema": {
        "type": "object",
        "properties": {
          "lua_code": {
            "type": "string",
            "description": "Nginx Lua 插件代码"
          }
        },
        "required": ["lua_code"]
      }
    },
    {
      "name": "generate_conversion_hints",
      "description": "基于 Lua 分析结果生成代码转换模板",
      "inputSchema": {
        "type": "object",
        "properties": {
          "analysis_result": {
            "type": "string",
            "description": "analyze_lua_plugin 返回的 JSON 格式分析结果"
          },
          "plugin_name": {
            "type": "string",
            "description": "目标插件名称（小写字母和连字符）"
          }
        },
        "required": ["analysis_result", "plugin_name"]
      }
    },
    {
      "name": "validate_wasm_code",
      "description": "验证生成的 Go WASM 插件代码，检查语法、API 使用、配置结构等，输出验证报告和改进建议",
      "inputSchema": {
        "type": "object",
        "properties": {
          "go_code": {
            "type": "string",
            "description": "生成的 Go WASM 插件代码"
          },
          "plugin_name": {
            "type": "string",
            "description": "插件名称"
          }
        },
        "required": ["go_code", "plugin_name"]
      }
    },
    {
      "name": "generate_deployment_config",
      "description": "为验证通过的 WASM 插件生成完整的部署配置包，包括 WasmPlugin YAML、Makefile、Dockerfile、README 和测试脚本",
      "inputSchema": {
        "type": "object",
        "properties": {
          "plugin_name": {
            "type": "string",
            "description": "插件名称"
          },
          "go_code": {
            "type": "string",
            "description": "验证通过的 Go 代码"
          },
          "config_schema": {
            "type": "string",
            "description": "配置 JSON Schema（可选）"
          },
          "namespace": {
            "type": "string",
            "description": "部署命名空间",
            "default": "higress-system"
          }
        },
        "required": ["plugin_name", "go_code"]
      }
    },
    {
      "name": "convert_lua_to_wasm",
      "description": "一键将 Nginx Lua 脚本转换为 Higress WASM 插件，自动生成 Go 代码和 WasmPlugin 配置。适合简单插件快速转换",
      "inputSchema": {
        "type": "object",
        "properties": {
          "lua_code": {
            "type": "string",
            "description": "要转换的 Nginx Lua 插件代码"
          },
          "plugin_name": {
            "type": "string",
            "description": "生成的 WASM 插件名称 (小写字母和连字符)"
          }
        },
        "required": ["lua_code", "plugin_name"]
      }
    }
  ]
}
